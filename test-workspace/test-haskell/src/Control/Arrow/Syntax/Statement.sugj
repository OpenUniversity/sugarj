module Control.Arrow.Syntax.Statement where

context-free syntax
  "let" HaskellDeclbinds -> ArrStmt {cons("ArrLetStmt")}
  HaskellPat "<-" ArrCommand -> ArrStmt {cons("ArrBindStmt")}
  ArrCommand -> ArrStmt {cons("ArrCmdStmt")}

context-free syntax
  "{" ArrExplStmtList "}" -> ArrStmtList {cons("ArrStmtList"), ignore-layout}
  ArrImplStmtList   -> ArrStmtList {cons("ArrStmtList")}

context-free syntax
  ArrStmt -> ArrExplStmtList
  ArrStmt ";" ArrExplStmtList -> ArrExplStmtList {cons("ArrStmtSeq")}

  ArrStmt -> ArrImplStmt {layout(gt(col(left(1)), col(first(1))))}

  ArrImplStmt -> ArrImplStmtList
  ArrImplStmt ArrImplStmtList -> ArrImplStmtList
   {cons("ArrStmtSeq"), layout(eq(col(first(1)), col(first(2))))}

