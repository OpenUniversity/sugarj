module Test.Lambda.Syntax where

import Prelude hiding (succ)

import Data.EBNF.Syntax
import Data.EBNF.Data
import Data.EBNF.Parser
import Data.EBNF.MetaSyntax

import Control.Monad.Identity
import Text.Parsec

Var ::= String {Var}

Exp ::= Var                  {EVar}
      | "(" Exp Exp ")"      {EApp}
      | "lambda" Var "." Exp {EAbs}
      | "(" Exp ")"

Env ::= "nil"               {Nil}
      | Var "=" Val ":" Env {Cons}
Val ::= "(" "lambda" Var "." Exp "," Env ")" {Closure}
