package trans;

import org.sugarj.languages.Java;
import org.sugarj.languages.Model;

import concretesyntax.Java;

public transformation ToJava {
  rules
    main = model-to-javaclass(body-trans)
    body-trans = make-main-method(single-stmt(println-stmt(compile-exp)))
  
  rules
    model-to-javaclass(s) :
      ModelDec(ModelDecHead(mods, name), ModelBody(body)) ->
      ClassDec(ClassDecHead(mods, name, None, None, None), ClassBody(<s> body))

  rules
    make-main-method(s) =
      s; ?body;
      !|[ public static void main(String[] args) { ~*body } ]|

    single-stmt(s) = ![<s>]

    println-stmt(s) = 
      s; ?exp;
      !|[ System.out.println(~exp); ]|

  signature constructors
    Add : Exp * Exp -> Exp

  rules
    compile-exp = is-int; !Lit(Deci(<int-to-string>))
    compile-exp : Add(e1, e2) -> |[ ~e1' + ~e2' ]|
      where <compile-exp> e1 => e1';
            <compile-exp> e2 => e2'
}