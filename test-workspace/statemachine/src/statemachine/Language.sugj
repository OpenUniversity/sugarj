package statemachine;

public sugar Language {
  desugarings
    statemachine-model

  rules
    statemachine-model :
      model@Statemachine(mods, name, body) -> 
      ModelDec(ModelDecHead(mods, name), ModelBody(("Statemachine", body)))

  context-free syntax
    Statemachine -> ToplevelDeclaration
    AnnoOrSugarMod* "statemachine" JavaId "{" StatemachineBody "}" -> Statemachine {cons("Statemachine")}

    InitialState EventDec* StateDec* -> StatemachineBody {cons("StatemachineBody")}

    JavaId -> StateName
    JavaId -> EventName

    "initial" "state" StateName -> InitialState {cons("InitialState")}

    "event" EventName -> EventDec {cons("Event")}
    "state" StateName "{" Transition* "}" -> StateDec {cons("State")}

    Event "=>" StateName -> Transition {cons("Transition")}

    EventName -> Event {cons("NamedEvent")}
}