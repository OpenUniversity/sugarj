package statemachine;

import template.Unquote;
import template.Shorthands;
import template.InlineShorthands;
import template.Foreach;

public template ToJava {
  $pkg = collect-one(?PackageDec(_,<id>))
  $classname = collect-one(?ModelDecHead(_,<id>))

  package $pkg;

  import java.lang.IllegalArgumentException;

  public class $classname {
    public static enum Event {
      PinOK, PinNOK
    }
    public static enum State {
      Init {
        public State step(Event e) {
          if (e == PinOK)
            return Init;
          throw new IllegalArgumentException();
        }
      };

      public abstract State step(Event e);
    }

    private State state;

    public State step(Event e) {
      state = state.step(e);
      return state;
    }

    public State run(Event[] es) {
      for (Event e : es)
        step(e);
      return state;
    }
  }
}